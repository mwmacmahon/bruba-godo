#!/bin/bash
# Bot command wrapper with transport abstraction
#
# Usage:
#   ./tools/bot <command>           # Run command as bot user
#   ./tools/bot clawdbot status     # Example: check status
#   ./tools/bot cat ~/clawd/FILE    # Example: read a file
#
# Transport is controlled by BOT_TRANSPORT env var:
#   sudo          - Same machine, different user (fastest)
#   tailscale-ssh - Tailscale SSH (no key management)
#   ssh           - Regular SSH with multiplexing (default)
#
# Example:
#   BOT_TRANSPORT=sudo ./tools/bot ls ~/agents

set -e

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
source "$SCRIPT_DIR/lib.sh"

load_config

if [[ $# -eq 0 ]]; then
    echo "Usage: bot <command>"
    echo ""
    echo "Examples:"
    echo "  bot clawdbot status"
    echo "  bot cat ~/clawd/AGENTS.md"
    echo "  bot 'ls -la ~/clawd/'"
    echo ""
    echo "Transport: $BOT_TRANSPORT"
    echo "User: $BOT_USER"
    echo "Host: $BOT_HOST"
    exit 1
fi

bot_exec "$@"
